<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Form/index.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Form/index.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState } from "react";
import { useDispatch } from "react-redux";
import { addEmployee } from "../../store/employeeSlice";
import Dropdown from "../Dropdown";
import DatePicker from "../Datepicker";
import states from "../../data/states";
import departments from "../../data/departments";
import "./style.scss";

/**
 * Form component for creating a new employee.
 * 
 * @param {function} onSubmitSuccess - Callback called after successful form submission.
 * 
 * - Handles all form fields and their state.
 * - Validates inputs using regex rules and required checks.
 * - Displays error messages and red borders for invalid fields.
 * - Prevents submission if the form is invalid.
 * - Uses custom Dropdown and DatePicker components.
 * 
 * @category Components
 * @component
 * @returns {React.Component} A React component of a form.
 */
function Form({ onSubmitSuccess }) {
  const dispatch = useDispatch();
  const [errors, setErrors] = useState({});
  const [filled, setfilled] = useState({});
  const [formData, setFormData] = useState({
    firstName: "",
    lastName: "",
    dateOfBirth: "",
    startDate: "",
    street: "",
    city: "",
    state: { name: "", abbreviation: "" },
    zipCode: "",
    department: "",
  });

  // Regex rules for validation
  const regexRules = {
    firstName: /^[A-Za-zÀ-ÿ' -]{2,30}$/,
    lastName: /^[A-Za-zÀ-ÿ' -]{2,30}$/,
    zipCode: /^\d{5}$/,
    city: /^[A-Za-zÀ-ÿ' -]{2,40}$/,
    street: /^.{2,60}$/,
  };

  // Validates a single field based on regex rules
  const isValid = (name, value) => {
    if (!regexRules[name]) return true;
    return regexRules[name].test(value);
  };

  // Checks if the entire form is valid
  const isFormValid = () => {
    for (const key in regexRules) {
      if (!isValid(key, formData[key])) return false;
    }
    if (
      !formData.dateOfBirth ||
      !formData.startDate ||
      !formData.state.abbreviation ||
      !formData.department
    )
      return false;
    return true;
  };

  /**
   * Handles input changes for all fields.
   * Updates form data, marks field as filled, and sets error state.
   */
  const handleChange = (e) => {
    const { name, value } = e.target;
    setfilled((prev) => ({ ...prev, [name]: true }));

    if (name === "state") {
      const selected = states.find((s) => s.abbreviation === value);
      setFormData((prev) => ({
        ...prev,
        state: selected
          ? { name: selected.name, abbreviation: selected.abbreviation }
          : { name: "", abbreviation: "" },
      }));
      setErrors((prev) => ({
        ...prev,
        state: !value,
      }));
    } else if (name === "department") {
      setFormData((prev) => ({ ...prev, [name]: value }));
      setErrors((prev) => ({
        ...prev,
        department: !value,
      }));
    } else if (name === "dateOfBirth" || name === "startDate") {
      setFormData((prev) => ({ ...prev, [name]: value }));
      setErrors((prev) => ({
        ...prev,
        [name]: !value,
      }));
    } else {
      setFormData((prev) => ({ ...prev, [name]: value }));
      setErrors((prev) => ({
        ...prev,
        [name]: !isValid(name, value),
      }));
    }
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    // Mark all fields as filled to show errors
    setfilled({
      firstName: true,
      lastName: true,
      dateOfBirth: true,
      startDate: true,
      street: true,
      city: true,
      state: true,
      zipCode: true,
      department: true,
    });
    // Set errors for all fields
    setErrors({
      firstName: !isValid("firstName", formData.firstName),
      lastName: !isValid("lastName", formData.lastName),
      dateOfBirth: !formData.dateOfBirth,
      startDate: !formData.startDate,
      street: !isValid("street", formData.street),
      city: !isValid("city", formData.city),
      state: !formData.state.abbreviation,
      zipCode: !isValid("zipCode", formData.zipCode),
      department: !formData.department,
    });
    // Empêche la soumission si le formulaire est invalide
    if (!isFormValid()) return;
    dispatch(addEmployee(formData));
    setFormData({
      firstName: "",
      lastName: "",
      dateOfBirth: "",
      startDate: "",
      street: "",
      city: "",
      state: { name: "", abbreviation: "" },
      zipCode: "",
      department: "",
    });
    if (onSubmitSuccess) onSubmitSuccess();
  };

  return (
    &lt;form onSubmit={handleSubmit} className="form">
      &lt;div className="form__section">
        &lt;label className="form__section__label">First Name:*&lt;/label>
        &lt;input
          className="form__section__input"
          type="text"
          name="firstName"
          value={formData.firstName}
          onChange={handleChange}
          aria-invalid={
            filled.firstName &amp;&amp; errors.firstName ? "true" : "false"
          }
        />
        {filled.firstName &amp;&amp; errors.firstName &amp;&amp; (
          &lt;span className="form__error">First name is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Last Name:*&lt;/label>
        &lt;input
          className="form__section__input"
          type="text"
          name="lastName"
          value={formData.lastName}
          onChange={handleChange}
          aria-invalid={filled.lastName &amp;&amp; errors.lastName ? "true" : "false"}
        />
        {filled.lastName &amp;&amp; errors.lastName &amp;&amp; (
          &lt;span className="form__error">last name is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Date of Birth:*&lt;/label>
        &lt;DatePicker
          name="dateOfBirth"
          value={formData.dateOfBirth}
          onChange={handleChange}
          ariaInvalid={
            filled.dateOfBirth &amp;&amp; errors.dateOfBirth ? "true" : "false"
          }
        />
        {filled.dateOfBirth &amp;&amp; errors.dateOfBirth &amp;&amp; (
          &lt;span className="form__error">Date of birth is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Start Date:*&lt;/label>
        &lt;DatePicker
          name="startDate"
          value={formData.startDate}
          onChange={handleChange}
          ariaInvalid={filled.startDate &amp;&amp; errors.startDate ? "true" : "false"}
        />
        {filled.startDate &amp;&amp; errors.startDate &amp;&amp; (
          &lt;span className="form__error">Start date is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Street:*&lt;/label>
        &lt;input
          className="form__section__input"
          type="text"
          name="street"
          value={formData.street}
          onChange={handleChange}
          aria-invalid={filled.street &amp;&amp; errors.street ? "true" : "false"}
        />
        {filled.street &amp;&amp; errors.street &amp;&amp; (
          &lt;span className="form__error">Street is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">City:*&lt;/label>
        &lt;input
          className="form__section__input"
          type="text"
          name="city"
          value={formData.city}
          onChange={handleChange}
          aria-invalid={filled.city &amp;&amp; errors.city ? "true" : "false"}
        />
        {filled.city &amp;&amp; errors.city &amp;&amp; (
          &lt;span className="form__error">City is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">State:*&lt;/label>
        &lt;Dropdown
          name="state"
          options={states.map((s) => ({
            label: s.name,
            value: s.abbreviation,
          }))}
          value={formData.state.abbreviation}
          onChange={handleChange}
          ariaInvalid={filled.state &amp;&amp; errors.state ? "true" : "false"}
        />
        {filled.state &amp;&amp; errors.state &amp;&amp; (
          &lt;span className="form__error">State is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Zip Code:*&lt;/label>
        &lt;input
          className="form__section__input"
          type="number"
          name="zipCode"
          value={formData.zipCode}
          onChange={handleChange}
          aria-invalid={filled.zipCode &amp;&amp; errors.zipCode ? "true" : "false"}
        />
        {filled.zipCode &amp;&amp; errors.zipCode &amp;&amp; (
          &lt;span className="form__error">5-digit zip code required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;label className="form__section__label">Department:*&lt;/label>
        &lt;Dropdown
          name="department"
          options={departments.map((s) => ({
            label: s.name,
            value: s.name,
          }))}
          value={formData.department}
          onChange={handleChange}
          ariaInvalid={
            filled.department &amp;&amp; errors.department ? "true" : "false"
          }
        />
        {filled.department &amp;&amp; errors.department &amp;&amp; (
          &lt;span className="form__error">Department is required&lt;/span>
        )}
      &lt;/div>
      &lt;div className="form__section">
        &lt;div className="form__section__button">
          &lt;button type="submit">Create&lt;/button>
        &lt;/div>
      &lt;/div>
    &lt;/form>
  );
}

export default Form;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#DatePicker">DatePicker</a></li><li><a href="global.html#Dropdown">Dropdown</a></li><li><a href="global.html#EmployeeList">EmployeeList</a></li><li><a href="global.html#Form">Form</a></li><li><a href="global.html#Home">Home</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Aug 10 2025 00:46:06 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
